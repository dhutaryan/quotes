import{$ as N,A as d,B as ot,C as u,D as q,E as h,F as f,G as g,H as nt,I as it,J as p,K as l,L as c,M as rt,N as k,O as v,P as at,Q as b,R as st,S as ct,T as mt,U as ut,Y as pt,_ as lt,a as V,b as U,ba as D,c as m,ca as dt,d as B,da as I,e as G,ea as ht,f as J,fa as ft,g as z,ga as gt,h as R,ha as Ct,i as w,ia as qt,j as H,ja as yt,k as W,ka as T,l as O,m as Y,n as K,o as X,p as Z,q as C,r as P,s as tt,t as et,u as j,v as Q,w as E,x as F,y as A,z as s}from"./chunk-ANIXELUL.js";var x={production:!0,quotableApi:"https://api.quotable.io",quoteGardenApi:"https://quote-garden.onrender.com/api/v3",dummyJsonApi:"https://dummyjson.com"};var _t=(()=>{let t=class t{buildQueryParams(e){return e}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();var M=(()=>{let t=class t{constructor(e,n){this._http=e,this._utilsService=n}random(){return J([this._randomQuotable(),this._randomQuoteGarden(),this._randomDummyJson()])}search(e){let n={page:e.page};e.author&&(n.author=e.author);let i=this._utilsService.buildQueryParams(n);return this._http.get(x.quotableApi+"/quotes",{params:i})}_randomQuotable(){return this._http.get(x.quotableApi+"/random").pipe(m(e=>({_id:e._id,content:e.content,author:e.author})))}_randomQuoteGarden(){return this._http.get(x.quoteGardenApi+"/quotes/random").pipe(m(e=>({_id:e.data[0]._id,content:e.data[0].quoteText,author:e.data[0].quoteAuthor})))}_randomDummyJson(){return this._http.get(x.dummyJsonApi+"/quotes/random").pipe(m(e=>({_id:e.id,content:e.quote,author:e.author})))}};t.\u0275fac=function(n){return new(n||t)(E(ut),E(_t))},t.\u0275prov=j({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();function jt(o,t){if(o&1&&(p(0,"div",0),c(1,"qt-rating"),l(),p(2,"q",1),b(3),l(),p(4,"div",2),c(5,"qt-twitter-share-button",3),p(6,"p",4),b(7),l()()),o&2){let r=v();s(3),st(r.quote.content),s(2),at("text",'"',r.quote.content,'" - ',r.quote.author,""),s(2),ct("\u2014 ",r.quote.author,"")}}function Qt(o,t){o&1&&c(0,"qt-skeleton",5)(1,"qt-skeleton",6)}var L=(()=>{let t=class t{constructor(){this.isLoading=!1}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=C({type:t,selectors:[["qt-quote-card"]],inputs:{quote:"quote",isLoading:"isLoading"},decls:2,vars:1,consts:[[1,"quote-card-rating"],[1,"quote-card-content"],[1,"quote-card-bottom"],[3,"text"],[1,"quote-card-author"],["height","1.5rem",1,"quote-card-content"],["height","1.25rem","width","8rem",1,"quote-card-author"]],template:function(n,i){n&1&&h(0,jt,8,4)(1,Qt,2,0),n&2&&g(0,i.quote&&!i.isLoading?0:1)},dependencies:[D,ht,T],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;padding:1rem;background-color:var(--bg-card);border-radius:.5rem;box-shadow:var(--shadow-card)}.quote-card-content[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:2rem;font-weight:500;font-style:italic}.quote-card-bottom[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.quote-card-author[_ngcontent-%COMP%]{margin-block:0;margin-left:auto;font-size:1.25rem}.quote-card-rating[_ngcontent-%COMP%]{align-self:flex-end;margin-top:-1rem;margin-right:-1rem;padding-right:.5rem;padding-top:.5rem}"],changeDetection:0});let o=t;return o})();function Dt(o,t){o&1&&c(0,"qt-alert",0)}var xt=(()=>{let t=class t{constructor(e){this._quotesService=e,this.quote=u(null),this.isLoading=u(!1),this.isError=u(!1)}ngOnInit(){this._fetchQuote()}nextQuote(){this._fetchQuote()}_fetchQuote(){let e=this.quote();this.isLoading.set(!0),this.isError.set(!1),this._quotesService.random().pipe(W()).subscribe({next:n=>this.quote.set(n),error:()=>{this.isError.set(!0),this.quote.set(e)},complete:()=>this.isLoading.set(!1)})}};t.\u0275fac=function(n){return new(n||t)(d(M))},t.\u0275cmp=C({type:t,selectors:[["qt-random-quote"]],decls:4,vars:4,consts:[["message","We couldn't load random quote. Try again later!"],[3,"quote","isLoading"],[1,"random-quote-next","outlined","primary",3,"disabled","click"]],template:function(n,i){n&1&&(h(0,Dt,1,0,"qt-alert",0),c(1,"qt-quote-card",1),p(2,"button",2),k("click",function(){return i.nextQuote()}),b(3,` Next
`),l()),n&2&&(g(0,i.isError()?0:-1),s(),f("quote",i.quote())("isLoading",i.isLoading()),s(),f("disabled",i.isLoading()))},dependencies:[I,L],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;flex-grow:1;gap:1rem;height:100%}.random-quote-next[_ngcontent-%COMP%]{align-self:flex-end}"],changeDetection:0});let o=t;return o})();function $(o){o||(A($),o=F(q));let t=new V(r=>o.onDestroy(r.next.bind(r)));return r=>r.pipe(K(t))}function S(o,t){let r=!t?.manualCleanup;r&&!t?.injector&&A(S);let e=r?t?.injector?.get(q)??F(q):null,n;t?.requireSync?n=u({kind:0}):n=u({kind:1,value:t?.initialValue});let i=o.subscribe({next:a=>n.set({kind:1,value:a}),error:a=>{if(t?.rejectErrors)throw a;n.set({kind:2,error:a})}});return e?.onDestroy(i.unsubscribe.bind(i)),ot(()=>{let a=n();switch(a.kind){case 1:return a.value;case 2:throw a.error;case 0:throw new Z(601,"`toSignal()` called with `requireSync` but `Observable` did not emit synchronously.")}})}var It=(o,t)=>t==null?null:t._id;function Tt(o,t){o&1&&c(0,"qt-alert",0)}function Mt(o,t){if(o&1&&c(0,"qt-quote-card",3),o&2){let r=t.$implicit,e=v();f("quote",r)("isLoading",e.isLoading())}}function Lt(o,t){if(o&1){let r=rt();p(0,"qt-pagination",4),k("pageChange",function(n){tt(r);let i=v();return et(i.onChangePage(n))}),l()}o&2&&f("page",t.page)("totalPages",t.totalPages)}var St=(()=>{let t=class t{constructor(e,n,i,a){this._quotesService=e,this._route=n,this._router=i,this._destroyRef=a,this._queryParams$=this._route.queryParams.pipe(O()),this._data$=this._fetchQuotesBasedOnQueryParams().pipe(O()),this.quotes=S(this._data$),this.paginator=S(this._data$.pipe(m(_=>({page:_.page,totalPages:_.totalPages})))),this.searchControl=new Ct(null),this.isLoading=u(!1),this.isError=S(this._data$.pipe(m(()=>!1),z(()=>U(!0))))}ngOnInit(){let e=this._route.snapshot.queryParams.author;this.searchControl.patchValue(e,{emitEvent:!1}),this.searchControl.valueChanges.pipe(R(300),m(n=>n?n.trim().toLocaleLowerCase():null),w(),$(this._destroyRef)).subscribe(n=>{this._goToPage({page:1,author:n})})}onChangePage(e){this._goToPage({page:e})}_fetchQuotesBasedOnQueryParams(){let e=this._getPageNumber$(),n=this._queryParams$.pipe(m(i=>i.author),w());return B([e,n]).pipe(R(0),X(()=>this.isLoading.set(!0)),Y(([i,a])=>this._quotesService.search({page:i,author:a}).pipe(H(()=>this.isLoading.set(!1)))))}_getPageNumber$(){return this._queryParams$.pipe(m(e=>Number(e.page)),G(e=>this._checkPageNumber(e)),w())}_checkPageNumber(e){return!e||e<1?(this._goToPage({page:1},!0),!1):!0}_goToPage(e,n=!1){return this._router.navigate(["/quotes","search"],{queryParams:e,queryParamsHandling:"merge",replaceUrl:n})}};t.\u0275fac=function(n){return new(n||t)(d(M),d(pt),d(lt),d(q))},t.\u0275cmp=C({type:t,selectors:[["qt-search-quote"]],decls:5,vars:3,consts:[["message","Your search request has been failed. Try another search query!"],["type","text","placeholder","Search by author",3,"formControl"],[3,"page","totalPages"],[3,"quote","isLoading"],[3,"page","totalPages","pageChange"]],template:function(n,i){if(n&1&&(h(0,Tt,1,0,"qt-alert",0),c(1,"input",1),nt(2,Mt,1,2,"qt-quote-card",3,It),h(4,Lt,1,2,"qt-pagination",2)),n&2){let a,_;g(0,i.isError()?0:-1),s(),f("formControl",i.searchControl),s(),it((a=i.quotes())==null?null:a.results),s(2),g(4,(_=i.paginator())?4:-1,_)}},dependencies:[dt,ft,gt,qt,I,L],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:1rem}"],changeDetection:0});let o=t;return o})();var Rt=[{path:"",pathMatch:"full",redirectTo:"random"},{path:"random",component:xt},{path:"search",component:St}],wt=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=P({type:t}),t.\u0275inj=Q({imports:[N.forChild(Rt),N]});let o=t;return o})();var Ue=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=P({type:t}),t.\u0275inj=Q({imports:[mt,D,yt,T,wt]});let o=t;return o})();export{Ue as QuotesModule};
