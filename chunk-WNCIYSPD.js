import{$ as st,A as f,B as g,C as Y,D as K,E as m,F as p,G as s,H as X,I as j,J as q,K as Z,L as _,M as tt,N as et,O as ot,P as nt,T as rt,V as it,W as O,Y as Q,Z as at,_ as k,a as A,aa as ct,b as u,ba as mt,c as F,ca as ut,d as N,da as pt,e as $,ea as lt,f as L,fa as D,g as b,h as V,i as U,j as B,k as G,l as R,m as C,n as x,o as J,p as z,q as S,r as w,s as E,t as H,u as W,v as a,w as d,x as c,y as P,z as h}from"./chunk-OLY6LZY7.js";var v={production:!0,quotableApi:"https://api.quotable.io",quoteGardenApi:"https://quote-garden.onrender.com/api/v3",dummyJsonApi:"https://dummyjson.com"};var dt=(()=>{let t=class t{buildQueryParams(e){return e}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();var I=(()=>{let t=class t{constructor(e,n){this._http=e,this._utilsService=n}random(){return $([this._randomQuotable(),this._randomQuoteGarden(),this._randomDummyJson()])}search(e){let n={page:e.page};e.author&&(n.author=e.author);let r=this._utilsService.buildQueryParams(n);return this._http.get(v.quotableApi+"/quotes",{params:r})}_randomQuotable(){return this._http.get(v.quotableApi+"/random").pipe(u(e=>({_id:e._id,content:e.content,author:e.author})))}_randomQuoteGarden(){return this._http.get(v.quoteGardenApi+"/quotes/random").pipe(u(e=>({_id:e.data[0]._id,content:e.data[0].quoteText,author:e.data[0].quoteAuthor})))}_randomDummyJson(){return this._http.get(v.dummyJsonApi+"/quotes/random").pipe(u(e=>({_id:e.id,content:e.quote,author:e.author})))}};t.\u0275fac=function(n){return new(n||t)(E(nt),E(dt))},t.\u0275prov=S({token:t,factory:t.\u0275fac,providedIn:"root"});let o=t;return o})();function _t(o,t){if(o&1&&(m(0,"div",0),s(1,"qt-rating"),p(),m(2,"q",1),_(3),p(),m(4,"div",2),s(5,"qt-twitter-share-button",3),m(6,"p",4),_(7),p()()),o&2){let i=q();a(3),tt(i.quote.content),a(2),Z("text",'"',i.quote.content,'" - ',i.quote.author,""),a(2),et("\u2014 ",i.quote.author,"")}}function vt(o,t){o&1&&s(0,"qt-skeleton",5)(1,"qt-skeleton",6)}var T=(()=>{let t=class t{constructor(){this.isLoading=!1}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=C({type:t,selectors:[["qt-quote-card"]],inputs:{quote:"quote",isLoading:"isLoading"},decls:2,vars:1,consts:[[1,"quote-card-rating"],[1,"quote-card-content"],[1,"quote-card-bottom"],[3,"text"],[1,"quote-card-author"],["height","1.5rem",1,"quote-card-content"],["height","1.25rem","width","8rem",1,"quote-card-author"]],template:function(n,r){n&1&&h(0,_t,8,4)(1,vt,2,0),n&2&&g(0,r.quote&&!r.isLoading?0:1)},dependencies:[Q,st,D],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;width:100%;padding:1rem;background-color:var(--bg-card);border-radius:.5rem;box-shadow:var(--shadow-card)}.quote-card-content[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:2rem;font-weight:500;font-style:italic}.quote-card-bottom[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.quote-card-author[_ngcontent-%COMP%]{margin-block:0;margin-left:auto;font-size:1.25rem}.quote-card-rating[_ngcontent-%COMP%]{align-self:flex-end;margin-top:-1rem;margin-right:-1rem;padding-right:.5rem;padding-top:.5rem}"],changeDetection:0});let o=t;return o})();function xt(o,t){o&1&&s(0,"qt-alert",0)}var gt=(()=>{let t=class t{constructor(e){this._quotesService=e,this.quote=c(null),this.isLoading=c(!1),this.isError=c(!1)}ngOnInit(){this._fetchQuote()}nextQuote(){this._fetchQuote()}_fetchQuote(){let e=this.quote();this.isLoading.set(!0),this.isError.set(!1),this._quotesService.random().pipe(V()).subscribe({next:n=>this.quote.set(n),error:()=>{this.isError.set(!0),this.quote.set(e)},complete:()=>this.isLoading.set(!1)})}};t.\u0275fac=function(n){return new(n||t)(d(I))},t.\u0275cmp=C({type:t,selectors:[["qt-random-quote"]],decls:4,vars:4,consts:[["message","We couldn't load random quote. Try again later!"],[3,"quote","isLoading"],[1,"random-quote-next","outlined","primary",3,"disabled","click"]],template:function(n,r){n&1&&(h(0,xt,1,0,"qt-alert",0),s(1,"qt-quote-card",1),m(2,"button",2),j("click",function(){return r.nextQuote()}),_(3,` Next
`),p()),n&2&&(g(0,r.isError()?0:-1),a(),f("quote",r.quote())("isLoading",r.isLoading()),a(),f("disabled",r.isLoading()))},dependencies:[k,T],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;flex-grow:1;gap:1rem;height:100%}.random-quote-next[_ngcontent-%COMP%]{align-self:flex-end}"],changeDetection:0});let o=t;return o})();function M(o){o||(W(M),o=H(P));let t=new A(i=>o.onDestroy(i.next.bind(i)));return i=>i.pipe(G(t))}var St=(o,t)=>t==null?null:t._id;function wt(o,t){o&1&&s(0,"qt-alert",0)}function Pt(o,t){if(o&1&&s(0,"qt-quote-card",3),o&2){let i=t.$implicit,e=q();f("quote",i)("isLoading",e.isLoading())}}function jt(o,t){if(o&1){let i=X();m(0,"qt-pagination",4),j("pageChange",function(n){J(i);let r=q();return z(r.onChangePage(n))}),p()}o&2&&f("page",t.page)("totalPages",t.totalPages)}var Ct=(()=>{let t=class t{constructor(e,n,r,l){this._quotesService=e,this._route=n,this._router=r,this._destroyRef=l,this.quotes=c(Array(10)),this.paginator=c(null),this.searchControl=new ut(null),this.isLoading=c(!1),this.isError=c(!1),this._queryParams$=this._route.queryParams.pipe(U())}ngOnInit(){let e=this._route.snapshot.queryParams.author;this.searchControl.patchValue(e,{emitEvent:!1}),this.searchControl.valueChanges.pipe(L(300),u(n=>n?n.trim().toLocaleLowerCase():null),b(),M(this._destroyRef)).subscribe(n=>{this._goToPage({page:1,author:n})}),this._fetchQuotesBasedOnQueryParams()}onChangePage(e){this._goToPage({page:e})}_fetchQuotesBasedOnQueryParams(){let e=this._getPageNumber$(),n=this._queryParams$.pipe(u(r=>r.author),b());F([e,n]).pipe(R(()=>this.isError.set(!1)),L(0),R(()=>this.isLoading.set(!0)),B(([r,l])=>this._quotesService.search({page:r,author:l})),M(this._destroyRef)).subscribe({next:r=>{this.quotes.set(r.results),this.paginator.set({page:r.page,totalPages:r.totalPages}),this.isLoading.set(!1)},error:()=>{this.isError.set(!0),this.isLoading.set(!1)}})}_getPageNumber$(){return this._queryParams$.pipe(u(e=>Number(e.page)),N(e=>this._checkPageNumber(e)),b())}_checkPageNumber(e){return!e||e<1?(this._goToPage({page:1},!0),!1):!0}_goToPage(e,n=!1){return this._router.navigate(["/quotes","search"],{queryParams:e,queryParamsHandling:"merge",replaceUrl:n})}};t.\u0275fac=function(n){return new(n||t)(d(I),d(rt),d(it),d(P))},t.\u0275cmp=C({type:t,selectors:[["qt-search-quote"]],decls:5,vars:3,consts:[["message","Your search request has been failed. Try another search query!"],["type","text","placeholder","Search by author",3,"formControl"],[3,"page","totalPages"],[3,"quote","isLoading"],[3,"page","totalPages","pageChange"]],template:function(n,r){if(n&1&&(h(0,wt,1,0,"qt-alert",0),s(1,"input",1),Y(2,Pt,1,2,"qt-quote-card",3,St),h(4,jt,1,2,"qt-pagination",2)),n&2){let l;g(0,r.isError()?0:-1),a(),f("formControl",r.searchControl),a(),K(r.quotes()),a(2),g(4,(l=r.paginator())?4:-1,l)}},dependencies:[at,ct,mt,pt,k,T],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:1rem}"],changeDetection:0});let o=t;return o})();var Qt=[{path:"",pathMatch:"full",redirectTo:"random"},{path:"random",component:gt},{path:"search",component:Ct}],yt=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=x({type:t}),t.\u0275inj=w({imports:[O.forChild(Qt),O]});let o=t;return o})();var Ae=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=x({type:t}),t.\u0275inj=w({imports:[ot,Q,lt,D,yt]});let o=t;return o})();export{Ae as QuotesModule};
